<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AWS Icons Test - Cloud Defenders</title>
    
    <!-- Version-aware base tag injection -->
    <script>
      // Fetch version manifest and inject base tag to resolve script paths
      (async function() {
        try {
          const manifestResponse = await fetch('/version-manifest.json', { cache: 'no-store' });
          if (manifestResponse.ok) {
            const manifest = await manifestResponse.json();
            if (manifest.version) {
              const baseTag = document.createElement('base');
              baseTag.href = `/${manifest.version}/`;
              document.head.insertBefore(baseTag, document.head.firstChild);
            }
          }
        } catch (error) {
          console.warn('Could not load version manifest, using default paths:', error);
        }
      })();
    </script>
    
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f0f0f0;
      }
      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
      }
      .icon-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .icon-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        background: #fafafa;
      }
      .icon-card h3 {
        margin: 0 0 10px 0;
        color: #333;
      }
      .icon-canvas {
        border: 1px solid #ccc;
        background: white;
        margin: 10px 0;
      }
      .size-test {
        margin-top: 30px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #f9f9f9;
      }
      .size-row {
        display: flex;
        align-items: center;
        margin: 10px 0;
        gap: 20px;
      }
      .size-label {
        width: 80px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>AWS Service Icons Test</h1>
      <p>Testing the new AWS-style icons for Cloud Defenders game targets.</p>

      <div class="icon-grid" id="iconGrid">
        <!-- Icons will be generated here -->
      </div>

      <div class="size-test">
        <h3>Size Scaling Test (S3 Icon)</h3>
        <div class="size-row">
          <span class="size-label">16px:</span>
          <canvas
            id="s3-16"
            width="32"
            height="32"
            class="icon-canvas"
          ></canvas>
        </div>
        <div class="size-row">
          <span class="size-label">24px:</span>
          <canvas
            id="s3-24"
            width="40"
            height="40"
            class="icon-canvas"
          ></canvas>
        </div>
        <div class="size-row">
          <span class="size-label">32px:</span>
          <canvas
            id="s3-32"
            width="48"
            height="48"
            class="icon-canvas"
          ></canvas>
        </div>
        <div class="size-row">
          <span class="size-label">48px:</span>
          <canvas
            id="s3-48"
            width="64"
            height="64"
            class="icon-canvas"
          ></canvas>
        </div>
        <div class="size-row">
          <span class="size-label">64px:</span>
          <canvas
            id="s3-64"
            width="80"
            height="80"
            class="icon-canvas"
          ></canvas>
        </div>
      </div>
    </div>

    <script src="js/aws-icons.js"></script>
    <script>
      // AWS services to test
      const services = [
        {
          type: 's3',
          name: 'S3 Bucket',
          description: 'Simple Storage Service',
        },
        {
          type: 'lambda',
          name: 'Lambda Function',
          description: 'Serverless Computing',
        },
        {
          type: 'rds',
          name: 'RDS Database',
          description: 'Relational Database Service',
        },
        {
          type: 'ec2',
          name: 'EC2 Instance',
          description: 'Elastic Compute Cloud',
        },
        {
          type: 'apigateway',
          name: 'API Gateway',
          description: 'API Management Service',
        },
        {
          type: 'dynamodb',
          name: 'DynamoDB',
          description: 'NoSQL Database Service',
        },
        {
          type: 'cloudfront',
          name: 'CloudFront CDN',
          description: 'Content Delivery Network',
        },
        {
          type: 'iam',
          name: 'IAM Service',
          description: 'Identity & Access Management',
        },
      ];

      // Generate icon cards
      const iconGrid = document.getElementById('iconGrid');

      services.forEach((service) => {
        const card = document.createElement('div');
        card.className = 'icon-card';

        const canvas = document.createElement('canvas');
        canvas.width = 80;
        canvas.height = 80;
        canvas.className = 'icon-canvas';

        const ctx = canvas.getContext('2d');

        // Render the icon
        AWSIcons.renderIcon(ctx, service.type, 40, 40, 48);

        card.innerHTML = `
                <h3>${service.name}</h3>
                <p style="font-size: 12px; color: #666; margin: 5px 0;">${service.description}</p>
            `;
        card.appendChild(canvas);

        // Add colour info
        const colour = AWSIcons.getServiceColour(service.type);
        const colourInfo = document.createElement('p');
        colourInfo.style.fontSize = '11px';
        colourInfo.style.color = '#888';
        colourInfo.style.margin = '5px 0 0 0';
        colourInfo.textContent = `Colour: ${colour}`;
        card.appendChild(colourInfo);

        iconGrid.appendChild(card);
      });

      // Size scaling test
      const sizes = [16, 24, 32, 48, 64];
      sizes.forEach((size) => {
        const canvas = document.getElementById(`s3-${size}`);
        const ctx = canvas.getContext('2d');
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        AWSIcons.renderIcon(ctx, 's3', centerX, centerY, size);
      });

      console.log('AWS Icons test page loaded successfully!');
      console.log(
        'Available services:',
        services.map((s) => s.type)
      );
    </script>
  </body>
</html>
